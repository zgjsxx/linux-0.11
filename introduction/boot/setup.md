- [setup.s](#setups)

# setup.s


|内存地址|长度|名称|描述|
|--|--|--|--|
|0x90000|2|光标位置||
|0x90002|2|扩展内存数||
|0x90004|2|显示页面||
|0x90006|1|显示模式||
|0x90008|2|?||
|0x9000A|1|显示内存||
|0x9000B|1|显示状态||
|0x9000C|2|特性参数||
|...||||
|0x90080|16|硬盘参数表||
|0x90090|16|硬盘参数表||
|0x901FC|2|根设备号||

下面要设置的是扩展内存的大小
```asm
mov	ah,#0x88
int	0x15
mov	[2],ax
```




调用中断是0x15， 功能号ah=0x88

结果是从0x100000(1M)之后的扩展内存的大小，单位是KB

由于这个时候的ds设置为0x9000, 所以[2] 代表0x90002, 因此扩展内存的大小就存放在0x90002地址处

该值在main函数中会被用到

```c
#define EXT_MEM_K (*(unsigned short *)0x90002)

memory_end = (1<<20) + (EXT_MEM_K<<10);     // 内存大小=1Mb + 扩展内存(k)* 1kb（1024 byte)
```

这里可以计算处内存的总大小。


下面这段则是获取硬盘参数
```asm
	mov	ax,#0x0000
	mov	ds,ax          !ds = 0
	lds	si,[4*0x41]    !这条指令将0x0000:0x0104单元存放的值赋值给si寄存器，将0x0000:0x0106单元存放的值赋给ds寄存器
	mov	ax,#INITSEG
	mov	es,ax
	mov	di,#0x0080     !es:di = 0x9000:0x0090
	mov	cx,#0x10       !循环16次
	rep
	movsb
```    
关于8086的中断向量表可以参考以下文档
https://wenku.baidu.com/view/b865a394c47da26925c52cc58bd63186bceb929f.html